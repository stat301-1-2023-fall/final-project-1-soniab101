---
title: "Progress Memo 2"
subtitle: |
  | Final Project 
  | Data Science 1 with R (STAT 301-1)
author: "Sonia Bhatia"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
---



::: {.callout-tip icon=false}

## Github Repo Link

My github link is below.

[https://github.com/stat301-1-2023-fall/final-project-1-soniab101](https://github.com/stat301-1-2023-fall/final-project-1-soniab101)

:::

::: {.callout-tip icon=false}

## Link to kaggle dataset (citation)

[World Cups and World Cup Matches datasets](https://www.kaggle.com/datasets/abecklas/fifa-world-cup?select=WorldCups.csv)

:::


```{r}
library(tidyverse)
library(skimr)
WorldCupMatchesCleaned <- read_csv("data/WorldCupMatchesCleaned.csv")
WorldCupsCleaned <- read_csv("data/WorldCupsCleaned.csv")
Cups_Matches_joined <- read_csv("data/Cups_Matches_joined.csv")

```

# summary of the datasets

# Investigating the data:
```{r}
glimpse(WorldCups)
glimpse(WorldCupMatches)

#skim(WorldCups)
#skim(WorldCupMatches)


```

# Cleaning the Data
I noticed that the team name Germany was coded both as Germany and also Germany FR. After investigating the meaning of this, I realized that Germany FR was West Germany before the country was reunified. I decided to recode Germany FR as Germany, since that is how the country is considered today, and their overall world cup wins are measured for the country as a whole officially. Additionally, I parsed the Datetime variable in the World Cup Matches dataset, and turned it into a date object. Also, in the merged dataset, I cleaned the 'attendance' variable names, since they were present in both separate datasets originally and represented different values. 

```{r}
WorldCupsCleaned <- mutate_if(WorldCups,
                                is.character,
                                stringr::str_replace_all, pattern = "Germany FR", replacement = "Germany")

WorldCupMatchesCleaned <- mutate_if(WorldCupMatches,
                                is.character,
                                stringr::str_replace_all, pattern = "Germany FR", replacement = "Germany")





```


# Univariate Analysis
I am investigating the distribution of the number of World Cups each of these countries has won.
```{r}

WorldCupsCleaned |> ggplot(aes(x= Winner)) + geom_bar(fill = "deepskyblue3") + labs(
  title = "Distribution of World Cup Wins by Country", x = "Country", y = "Total Wins")

```



#Bivariate Analysis
I am exploring the 
```{r}
#| label: fig-sub-regions-bar
#| fig-cap: Information on the trend of total goals scored in the World Cup since 1930
WorldCupsCleaned |> ggplot(aes(x=Year,y=GoalsScored)) +
  geom_line(color = "darkorchid") +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(title = "Total Goals Scored in the World Cup over the Years", x = "Year", y = "Total Goals", caption = "Source: Fifa World Cup Archive")
```


# Summary of Progress





